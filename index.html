<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0071)http://courses.cms.caltech.edu/cs11/material/projects/project-plan.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>CS11 Project Plan Outline and Weekly Reports</title>

<style type="text/css">

dt {
  margin-top: 2em ;
  font-weight: bold ;
}

</style>

</head>

<body>

<h2>CS11 Project Plan Outline</h2>

<p>
  Justin Leong's project plan outline for 2017 CS11 Spring Term. Scroll down
  for weekly reports.
</p>

<hr>

<dl>

<dt>Webpage</dt>
<dd>
  The project is to create a personal website and blog with an Elixir backend
  and Elm frontend.
</dd>

<dt>Description</dt>
<dd>
<p>
  The goal for this project is to become more familiar with Elixir and to
  learn Elm while using these languages to build a personal website. Since
  Elm and Elixir are both functional languages, I will be able to develop
  my functional programming skills and be exposed to what is hopefully a
  better frontend language than Javascript.
</p>
<p>
  I will also be learning how to set up a DNS and building the site up from
  scratch and exploring the Phoenix web framework.
</p>
</dd>

<dt>Programming Language(s)</dt>
<ul>
  <li>
    Elixir - I have used Elixir before for a internal reviews application for
    my internship last summer.  I worked on it during a weekend hackathon and
    two week sprint so I have limited experience. I wanted to become more
    familiar with a functional language and was debating between Ocaml,
    Clojure, Scala, Elixir, Scheme, or another Lisp.  I also wanted to learn
    how to use Lisp macros and it looks like Elixir supports macros.
    <a href="http://elixir-lang.org/getting-started/meta/macros.html">
      http://elixir-lang.org/getting-started/meta/macros.html</a>
  </li>
  <li>
    Elm - I haven't used Elm before but hope to learn it. I've heard good
    things about the frontend language from the Second Spectrum CTO. It was
    implemented in Haskell and took a lot of the design philosophy (statically
    typed functional) of Haskell. I interned at Second Spectrum and will work
    there after I graduate.
  </li>
  <li>
    Javascript - I know the basics from CS11 and last summer's internship.
  </li>
  <li>
    HTML - I know the basics from last summer's internship.
  </li>
</ul>

<dt>External Libraries</dt>
<dd>
  Phoenix - an Elixir web framework; I have used it in the internal reviews
  application for my internship last summer.
</dd>

<dt>Risk Analysis</dt>
<dd>
  <ul>
    <li>
      <p>
        I am unfamiliar with setting up my own server and domain name. To
        mitigate this risk, I bought a domain on dnsimple and a server on
        Digital Ocean (called a "Droplet") over spring break. I only had to
        pay for registering the domain since the GitHub Student Developer Pack
        offers one year credit for using Digital Ocean and for a DNS plan.
      </p>
    </li>
    <li>
      <p>
        I am unfamiliar with the Elm programming language. I will do some Elm
        tutorials before working on the website to gain some familiarity with
        the language. Also, the milestones in the implementation are mostly
        focused on creating functionality rather than a good UI except for
        Week 8 which is dedicated to experimenting with Elm to improve the web
        pages.
        <a href="https://www.elm-tutorial.org/en/">
          https://www.elm-tutorial.org/en/</a>
      </p>
    </li>
    <li>
      <p>
        I have limited familiarity with Elixir and Phoenix. I dedicated an
        entire week to setting up the framework on the server. I also allocate
        part of Week 5 to catch up in case I fall behind on this step. In
        addition, I chose to go with Phoenix and Elixir over Yesod and Haskell
        partially due to the additional documentation.
        <a href="http://www.phoenixframework.org/docs/learning-elixir-and-erlang">
          http://www.phoenixframework.org/docs/learning-elixir-and-erlang</a>
      </p>
    </li>
  </ul>
</dd>

<dt>Implementation Plan</dt>
<dd>
  <p>
    Since I am a senior, I will have 10 weeks instead of 11 to complete this
    project.
  </p>
  <p>
    Week 1 - Go through the Elm tutorial and make any necessary revisions to
    project plan outline.
  </p>
  <p>
    Week 2 - Finish setting up basic page using the Phoenix web framework.
    Either integrate this into GitHub Pages or on my Digital Ocean
    Droplet/server.
  </p>
  <p>
    Week 3 - Implement backend to hold blog posts, titles, dates, etc. using
    Elixir.
  </p>
  <p>
    Week 4 - Create simplistic home page which displays the titles and dates
    for blog posts using Elm.  Design should be similar to
    <a href="http://openmymind.net/">Karl Seguin's blog</a>
  </p>
  <p>
    Week 5 - Write unit tests for backend (and frontend if possible) and catch
    up on previous weeks if necessary.
  </p>
  <p>
    Week 6 - Implement pages for displaying blog posts. Add links to GitHub
    and LinkedIn.
  </p>
  <p>
    Week 7 - Implement logging for correctness. Log 404s, etc.
  </p>
  <p>
    Week 8 - Experiment with Elm features to make the web pages look good.
  </p>
  <p>
    Week 9 - Optimize for speed and displaying on mobile.
  </p>
  <p>
    Week 10 - Continue optimizing, catch up on any parts that I missed and
    write a blog post with my final report and what I learned from the
    project.
  </p>
</dd>

<dt>Source Code Availability</dt>
<dd>
  <p>
    Source code is available at <a href="https://github.com/omegaphoenix/omegaphoenix.github.com">GitHub</a>.
  </p>
  <p>
    Webpage will be available at <a href="http://jkleong.com">jkleong.com</a>.
  </p>
  <p>
    Project outline and updates are available on <a href="https://omegaphoenix.github.io/">https://omegaphoenix.github.io/</a>.
  </p>
</dd>

</dl>

<hr>

<h2>CS11 Weekly Report 1</h2>
<dl>
<dt>Tasks Accomplished</dt>
<dd>
  <ul>
    <li>
      <p>
        Finished project proposal and updated it to use Phoenix and Elixir
        instead of Haskell and Hapstack/Yesod.
      </p>
    </li>
    <li>
      <p>
        Installed Elm, Elixir, Erlang, Postgres, Phoenix.
      </p>
    </li>
    <li>
      <p>
        Started tutorial on
        <a href="http://www.cultivatehq.com/posts/phoenix-elm-1/">
          Phoenix with Elm</a> on Cultivate. Got a Phoenix web application
        running (Part 1) and integrated Elm using Brunch (Part 2) to
        automatically build the Elm file. Created a simple view (Part 3).
        Added a model and enhanced the view.
      </p>
    </li>
  </ul>
</dd>

<dt>Issues Encountered</dt>
<dd>
  <ul>
    <li>
      <p>
        Couldn't get elm-reactor to run using elm@^0.17.0 or elm@^0.18.0.
        It worked using elm@^0.16.0.
        I tried asking about this issue on the Elm slack channel but I didn't
        get any useful responses.
        Since version 0.18.0 was required for the Elm tutorial, I found a
        different tutorial to follow on
        <a href="http://www.cultivatehq.com/posts/phoenix-elm-1/">
          Phoenix with Elm</a> on Cultivate.
      </p>
    </li>
    <li>
      <p>
        Elixir wasn't connecting to the Postgres server correctly on
        "mix ecto.create".  The error was "Error tcp connect: non-existing
        domain - :nxdomain". To fix this, I had to set the hostname to
        "0.0.0.0" instead of "localhost" in config/dev.exs and
        config/test.exs. Also had to modify port to 5432 and listen_addresses
        to '*' in /etc/postgresql/9.6/main/postgresql.conf. I also uninstalled
        postgres 9.5 since I had multiple instances (9.5 and 9.6) running at
        one point. Before modifying the postgresql.conf file, I could not even
        log into postgres and access the postgres user since it was looking
        for 5432 but the port was something else.
      </p>
    </li>
    <li>
      <p>
        Couldn't "apt install esl-erlang" due to broken dependencies. Tried
        autoclean, clean, -f, and various other tricks to fix them.  Ended up
        running Synaptic Package Manager and removing all other erlang
        packages (erlang-doc, etc.) and then the conflicts were resolved and
        esl-erlang could be installed. The elixir package had already been
        installed.
      </p>
    </li>
    <li>
      <p>
        Couldn't get anything to display at first after integrating Elm.
        Looked at example code for tutorial and realized I was missing a line
        in brunch-config.js ("web/elm/SeatSaver.elm").
      </p>
    </li>
    <li>
      <p>
        Brunch is not automatically recompiling after modifying an Elm page.
      </p>
    </li>
  </ul>
</dd>

<dt>Next Week's Tasks</dt>
<dd>
  <ul>
    <li>
      <p>
        Continue <a href="http://www.cultivatehq.com/posts/phoenix-elm-1/">
          Phoenix with Elm tutorial</a>. [Decided to punt on this after
        meeting with Mike]
      </p>
    </li>
    <li>
      <p>
        Reinstall all dependencies on Digital Ocean server. [Done]
      </p>
    </li>
    <li>
      <p>
        Get Postgres running on server. [Done]
      </p>
    </li>
    <li>
      <p>
        Get basic Phoenix web application with Elm running on server. [Done]
      </p>
    </li>
  </ul>
</dd>

<dt>Meeting Notes</dt>
<dd>
  <ul>
    <li>
      <p>
        Hold off on <a href="http://www.cultivatehq.com/posts/phoenix-elm-1/">
          Phoenix with Elm tutorial</a>. Work on backend first. [Started]
      </p>
    </li>
    <li>
      <p>
        Get <a href="https://www.manning.com/books/elm-in-action">
          Elm in Action</a>,
          <a href="https://pragprog.com/book/elixir13/programming-elixir-1-3">
          Programming Elixir</a>, and
          <a href="https://pragprog.com/book/phoenix/programming-phoenix">
          Programming Phoenix</a>.
        Consider
          <a href="https://pragprog.com/book/cmelixir/metaprogramming-elixir">
          Metaprogramming Elixir</a> for macros, and
          <a href="https://pragprog.com/book/lhelph/elixir-and-phoenix">
          Functional Web Development with Elixir, OTP, and Phoenix</a>.
      </p>
    </li>
    <li>
      <p>
        Add authentication to website. See Programming Phoenix Chapter 5.
        [Done]
      </p>
    </li>
  </ul>
</dd>

</dl>

<hr>

<h2>CS11 Weekly Report 2</h2>
<dl>
  <dt>Tasks Accomplished</dt>
  <dd>
  <ul>
    <li>
      <p>
      Installed Elm, Elixir, Erlang, Postgres, Phoenix, byobu on server.
      Installed Elm, Elixir, Erlang, Postgres, Phoenix on VirtualBox (same
      distro as the server - Ubuntu 16.04).
      </p>
    </li>
    <li>
      <p>
      Tried deploying app on server using
      <a href="http://www.phoenixframework.org/docs/advanced-deployment">
        Exrm</a>. Got it running on port 4000
      for <a href="http://138.68.62.145:4000/">dev</a> and port 4001
      for <a href="http://138.68.62.145:4001/">prod</a> using the
      <a href="http://www.phoenixframework.org/v1.2.0/docs/deployment">
        basic guide</a>.
      </p>
    </li>
    <li>
      <p>
      Finished everything before "Preparing the Distillery Release" section
      in this
      <a href="https://dennisreimann.de/articles/phoenix-deployment-gatling-ubuntu-digital-ocean.html">
        Gatling</a> tutorial.
      </p>
    </li>
    <li>
      <p>
      Set up NGINX to listen on port 80 and forward to port 4000 and added
      DNS records for *.jkleong.com, www.jkleong.com, jkleong.com.
      Successfully configured it to show Phoenix app!
      </p>
    </li>
  </ul>
  </dd>

  <dt>Issues Encountered</dt>
  <dd>
  <ul>
    <li>
      <p>
      Installation was running smoothly until I tried to install elm using
      npm. Using root access at the lts version of npm fixed that on the
      server but path was missing on VirtualBox. I installed nvm and
      removed and reinstalled nodejs on VirtualBox Xubuntu 16.04.
      </p>
    </li>
    <li>
      <p>
      error:  Failed to load brunch config - Unexpected string ^G - Fixed
      error by using LTS version of node (v6.10.2 instead v7)
      </p>
    </li>
    <li>
      <p>
      "npm install" failing on VirtualBox despite using the same version as
      on the server.
      "npm install <packagename> --registry http://registry.npmjs.org/"
      works. Also fixes first issue encountered this week when installing
      Elm.
      </p>
    </li>
    <li>
      <p>
      Wasn't sure whether to use Distillery with Gatling,
      <a href="http://www.phoenixframework.org/docs/advanced-deployment">
        Exrm with manual deployment</a>, or
      <a href="https://hackernoon.com/state-of-the-art-in-deploying-elixir-phoenix-applications-fe72a4563cd8">
        Docker with ansible</a>.
      </p>
    </li>
    <li>
      <p>
      Ping'ing worked but going to <a href="http://jkleong.com">jkleong.com</a> did not work
      despite <a href="http://138.68.62.145:4000/">138.68.62.145:4000</a>
      working.  Got the nginx welcome screen after waiting for a while.
      Using
      <a href="https://dennisreimann.de/articles/phoenix-nginx-config.html">
      this basic configuration</a> got me to the same page as
      <a href="http://138.68.62.145:4000/">138.68.62.145:4000</a>.

      </p>
    </li>
  </ul>
  </dd>

  <dt>Next Week's Tasks</dt>
  <dd>
  <ul>
    <li>
      <p>
      Start hacking backend following this guide:
      <a href="https://hackernoon.com/introduction-fe138ac6079d">
        Writing a Blog Engine in Phoenix and Elixir</a>. [Started]
      </p>
    </li>
    <li>
      <p>
      Catch up on figuring out how to deploy app if I have time using
      <a href="https://hexdocs.pm/distillery/use-with-phoenix.html">
        Distillery</a> and following
      <a href="https://dennisreimann.de/articles/phoenix-deployment-gatling-ubuntu-digital-ocean.html">
        the Gatling tutorial</a>. [Decided to punt on this after meeting with
      Mike]
      </p>
    </li>
  </ul>
  </dd>

  <dt>Meeting Notes</dt>
  <dd>
  <ul>
    <li>
      <p>
      Don't worry about deployment. Punt on Gatling deployment. [Done in Week
      4]
      </p>
    </li>
    <li>
      <p>
      Work on backend/follow the tutorial,
      <a href="https://hackernoon.com/introduction-fe138ac6079d">
        Writing a Blog Engine in Phoenix and Elixir</a>. [Started]
      </p>
    </li>
  </ul>
  </dd>
</dl>

<hr>

<h2>CS11 Weekly Report 3</h2>
<dl>
  <dt>Tasks Accomplished</dt>
  <dd>
  <ul>
    <li>
      <p>
      Add posts and tests for posts.
      <a href="http://localhost:4000/posts">
        http://localhost:4000/posts</a>.
      <a href="http://jkleong.com/posts">
        http://jkleong.com/posts</a>.
      Test "Listing posts" page and HTML with status of 200.
      Test creating new posts in Elixir.
      Test "renders page not found when post id is nonexistent".
      Test deleting posts.
      </p>
    </li>
    <li>
      <p>
      Add user creation but not log in and no password encryption yet.
      <a href="http://localhost:4000/users">
        http://localhost:4000/users</a>.
      <a href="http://jkleong.com/users">
        http://jkleong.com/users</a>.
      </p>
    </li>
    <li>
      <p>
      Save password hash using Comeonin.Bcrypt for encryption.
      <a href="http://localhost:4000/users">
        http://localhost:4000/users</a>.
      <a href="http://jkleong.com/users">
        http://jkleong.com/users</a>.
      Test for comeonin call.
      Test for nil password.
      </p>
    </li>
    <li>
      <p>
      Enable login with login form.
      <a href="http://localhost:4000/sessions/new">
        http://localhost:4000/sessions/new</a>.
      <a href="http://jkleong.com/sessions/new">
        http://jkleong.com/sessions/new</a>.
      Test showing the login form.
      Test creating new user session for valid user.
      Test whether session is created for bad login.
      Test whether session is created for nonexistent user.
      </p>
    </li>
    <li>
      <p>
      Expose current user so that we can see log in, log out, and login
      failures.
      Test current user returns the user in session.
      Test current user returns nothing if there is no user in the session.
      Test deleting the user session.
      </p>
    </li>
    <li>
      <p>
      Fix login bug "nil given for :username, comparison with nil is forbidden
      as it always evaluates to false. Pass a full query expression and use
      is_nil/1 instead." Added function to handle invalid logins. Prevent
      hackers from determining valid usernames by making the timing consistent
      for real and fake usernames.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Issues Encountered</dt>
  <dd>
  <ul>
    <li>
      <p>
      "curl -iL http://jkleong.com" and going to the webpage works in
      Virtualbox but not on Mac or Android where it shows the nginx welcome
      screen instead of the Phoenix one. The problem was that "listen 80;" in
      nginx only listens on IPv4 and I had set Digital Ocean to use IPv6 as
      well as IPv4. Adding the line "listen [::]:80;" handled IPv6 as well.
      </p>
    </li>
    <li>
      <p>
      Ran into the same problem as Week 1 when I tried to work back on my own
      Xubuntu laptop.
      Elixir wasn't connecting to the Postgres server correctly on
      "mix ecto.create".  The error was "Error tcp connect: non-existing
      domain - :nxdomain". To fix this, I had to set the hostname to
      "0.0.0.0" instead of "localhost" in config/dev.exs and
      config/test.exs. Also had to modify port to 5432 and listen_addresses
      to '*' in /etc/postgresql/9.6/main/postgresql.conf.
      Not sure if this issue is because of postgresql 9.6 or if it is because
      I modified the posgresql.conf file before on this computer.
      Hooray for documentation!
      </p>
    </li>
    <li>
      <p>
      Password confirmation during account creation doesn't work yet.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Next Week's Tasks</dt>
  <dd>
  <ul>
    <li>
      <p>
      Continue hacking backend following this guide:
      <a href="https://hackernoon.com/introduction-fe138ac6079d">
        Writing a Blog Engine in Phoenix and Elixir</a>. [Continued]
      </p>
    </li>
    <li>
      <p>
      Specifically, work on
      <a href="https://hackernoon.com/writing-a-blog-engine-in-phoenix-part-2-authorization-814c06fa7c0">
        Authorization</a>. [Done]
      </p>
    </li>
  </ul>
  </dd>

  <dt>Meeting Notes</dt>
  <dd>
  <ul>
    <li>
      <p>
      Switch over the https to prevent packet sniffing. Add SSL and implement
      authorization for posts. [Done]
      </p>
    </li>
    <li>
      <p>
      Better error page for invalid username/password. [Done]
      </p>
    </li>
  </ul>
  </dd>
</dl>

<hr>

<h2>CS11 Weekly Report 4</h2>
<dl>
  <dt>Tasks Accomplished</dt>
  <dd>
  <ul>
    <li>
      <p>
      Add new migration to associate posts with users.
      </p>
    </li>
    <li>
      <p>
      Create pages to show all posts for a user.
      Restrict posting to users. Fix tests broken by adding this feature.
      <a href="http://localhost:4000/users/1/posts">
        http://localhost:4000/users/1/posts</a>.
      <a href="http://jkleong.com/users/1/posts">
        http://jkleong.com/users/1/posts</a>.
      </p>
    </li>
    <li>
      <p>
      Add tests for user authorization
      (<a href="https://github.com/omegaphoenix/omegaphoenix.github.com/commit/8b628c25feed8caaaf708065307a2c94111c3294">
        commit 8b628c2</a>).
      </p>
    </li>
    <li>
      <p>
      Deploy using NGINX, Distillery, and Gatling
      <a href="https://dennisreimann.de/articles/phoenix-deployment-gatling-ubuntu-digital-ocean.html">
        NGINX, Distillery, and Gatling</a>. We had decided to punt on this
      before but it was necessary to use releases by Distillery or Exrm to
      enable SSL.
      </p>
    </li>
    <li>
      <p>
      Request an SSL certificate.
      The *.pem files are in /etc/letsencrypt/archive and symbolic links are
      at /etc/letsencrypt/live/jkleong.com
      "sudo letsencrypt certonly -a webroot --webroot-path=/var/www/html -d jkleong.com -d www.jkleong.com"
      Generate Strong Diffie-Hellman Group at /etc/ssl/certs/dhparam.pem
      <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04?refcode=63eb025a3190">
        Digital Ocean "Let's Encrypt" Documentation</a>
      </p>
    </li>
    <li>
      <p>
      Enable SSL/https/http2 following
      <a href="https://dennisreimann.de/articles/phoenix-nginx-config.html">
        Dennis Reimann's NGINX configuration tutorial</a>.
      Check out
      <a href="https://www.ssllabs.com/ssltest/analyze.html?d=jkleong.com">
        the Qualys SSL Labs Report</a> which gave
      <a href="http://jkleong.com">
        http://jkleong.com</a> which redirects to
      <a href="https://jkleong.com">
        https://jkleong.com</a> an A+ for SSL encryption.
      </p>
    </li>
    <li>
      <p>
      Add chron job to automatically renew Let's Encrypt certificates.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Issues Encountered</dt>
  <dd>
  <ul>
    <li>
      <p>
      After running "iex -S mix" and "Repo.all(assoc(user, :posts))", I got
      the following error: <br>
      [debug] QUERY ERROR source="posts" db=4.7ms
      SELECT p0."id", p0."title", p0."body", p0."user_id", p0."inserted_at", p0."updated_at" FROM "posts" AS p0 WHERE (p0."user_id" = $1) [1]<br>
      ** (Postgrex.Error) ERROR 42703 (undefined_column): column p0.user_id does not exist<br>
          (ecto) lib/ecto/adapters/sql.ex:436: Ecto.Adapters.SQL.execute_and_cache/7<br>
          (ecto) lib/ecto/repo/queryable.ex:130: Ecto.Repo.Queryable.execute/5<br>
          (ecto) lib/ecto/repo/queryable.ex:35: Ecto.Repo.Queryable.all/4
      </p>
      <p>
      Fixed by doing "mix ecto.drop" before "mix ecto.create" and
      "mix ecto.migrate". Apparently we needed to drop the table before we
      could apply the migration that added user_id to posts. "mix ecto.reset"
      also works (drop+create+migrate) and "ecto.setup" (create+migrate).
      </p>
    </li>
    <li>
      <p>
      sudo service nginx configtest" failed after fresh install of nginx.
      Needed to remove /etc/nginx/sites-enabled/default so that it would use
      /etc/nginx/sites-available/the_juice as generated by Gatling.
      </p>
    </li>
    <li>
      <p>
      Got 502 Bad Gateway nginx error page after deploying with Gatling.
      Gatling generated a nginx file with the wrong port number. Changed it
      to the port number in /etc/init.d
      </p>
    </li>
    <li>
      <p>
      Gatling deployment failed to load static assets. Removed priv/static
      from .gitignore and added those files.
      </p>
    </li>
    <li>
      <p>
      Internel server error when accessing
      <a href="http://jkleong.com/users">
        http://jkleong.com/users</a>.<br>
      22:27:14.470 request_id=2evcgi97km05s5957fqg26psb69dei7c [info] GET /users<br>
      22:27:14.473 request_id=2evcgi97km05s5957fqg26psb69dei7c [info] Sent 500 in 3ms<br>
      22:27:14.477 [error] Ranch listener TheJuice.Endpoint.HTTP had connection process started with :cowboy_protocol:start_link/4 at #PID<0.1721.0> exit with reason: {{%Postgrex.Error{connection_id: 16052, message: nil, postgres: %{code: :undefined_table, file: "parse_relation.c", line: "1160", message: "relation \"users\" does not exist", pg_code: "42P01", position: "105", routine: "parserOpenTable", severity: "ERROR"}}, [{Ecto.Adapters.SQL, :execute_and_cache, 7, [file: 'lib/ecto/adapters/sql.ex', line: 436]}, {Ecto.Repo.Queryable, :execute, 5, [file: 'lib/ecto/repo/queryable.ex', line: 130]}, {Ecto.Repo.Queryable, :all, 4, [file: 'lib/ecto/repo/queryable.ex', line: 35]}, {TheJuice.UserController, :index, 2, [file: 'web/controllers/user_controller.ex', line: 7]}, {TheJuice.UserController, :action, 2, [file: 'web/controllers/user_controller.ex', line: 1]}, {TheJuice.UserController, :phoenix_controller_pipeline, 2, [file: 'web/controllers/user_controller.ex', line: 1]}, {TheJuice.Endpoint, :instrument, 4, [file: 'lib/the_juice/endpoint.ex', line: 1]}, {TheJuice.Router, :dispatch, 2, [file: 'lib/phoenix/router.ex', line: 261]}]}, {TheJuice.Endpoint, :call, [%Plug.Conn{adapter: {Plug.Adapters.Cowboy.Conn, :...}, assigns: %{}, before_send: [], body_params: %Plug.Conn.Unfetched{aspect: :body_params}, cookies: %Plug.Conn.Unfetched{aspect: :cookies}, halted: false, host: "jkleong.com", method: "GET", owner: #PID<0.1721.0>, params: %Plug.Conn.Unfetched{aspect: :params}, path_info: ["users"], path_params: %{}, peer: {{127, 0, 0, 1}, 50074}, port: 80, private: %{}, query_params: %Plug.Conn.Unfetched{aspect: :query_params}, query_string: "", remote_ip: {127, 0, 0, 1}, req_cookies: %Plug.Conn.Unfetched{aspect: :cookies}, req_headers: [{"x-real-ip", "131.215.159.175"}, {"x-forwarded-for", "131.215.159.175"}, {"host", "jkleong.com"}, {"connection", "upgrade"}, {"cache-control", "max-age=0"}, {"upgrade-insecure-requests", "1"}, {"user-agent", "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.75 Safari/537.36"}, {"accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"}, {"dnt", "1"}, {"accept-encoding", "gzip, deflate, sdch"}, {"accept-language", "en-US,en;q=0.8"}, {"cookie", "_the_juice_key=SFMyNTY.g3QAAAABbQAAAAtfY3NyZl90b2tlbm0AAAAYV2hleEJIQXM3dTFJNEVKeDRaUUNnQT09.9zvl95evBntKIOgi-7Rf7Y4dBzpZ7JWrlmD-pVL7s40"}], request_path: "/users", resp_body: nil, resp_cookies: %{}, resp_headers: [{"cache-control", "max-age=0, private, must-revalidate"}], scheme: :http, script_name: [], secret_key_base: nil, state: :unset, status: nil}, []]}}
      </p>
      <p>
      Fixed by manually calling "mix ecto.reset" after checking out
      <a href="https://github.com/omegaphoenix/omegaphoenix.github.com/commit/af9ee1563dfaeb8e10f9c34bf6c41e07a805bed1">
        last commit before moving the files for the distillery release</a>.
      The problem was that database migration was never called but I wasn't
      sure how to ensure that Distillery/Gatling performs that.
      </p>
    </li>
    <li>
      <p>
      Got 502 Bad Gateway nginx error page after restarting the_juice on the
      server. "sudo service the_juice start" failed but "sudo service
      the_juice restart" fixed the 502 error.
      </p>
    </li>
    <li>
      <p>
      Got "nginx: [emerg] "http" directive is not allowed here in /etc/nginx/sites-enabled/default:1"
      when running nginx configtest.
      <a href="http://stackoverflow.com/questions/43643829/nginx-emerg-http-directive-is-not-allowed-here-in-etc-nginx-sites-enabled">
        Stack Overflow</a> revealed that it was because the "ect/nginx/nginx.conf
      file also had http. Commenting out those lines in
      "/etc/nginx/sites-available/the_juice" fixed the issue.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Next Week's Tasks</dt>
  <dd>
  <ul>
    <li>
      <p>
      <a href="https://hackernoon.com/writing-a-blog-engine-in-phoenix-and-elixir-part-3-adding-roles-to-our-models-3be45a4afe4b">
        Add user and admin roles</a>.
      </p>
    </li>
    <li>
      <p>
      <a href="https://hackernoon.com/writing-a-blog-engine-in-phoenix-and-elixir-part-4-adding-roles-to-our-controllers-9f4678b48468">
        Restrict user and admin roles to prevent non-admin users from deleting
        everyone's account or posts across the board.</a>.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Meeting Notes</dt>
  <dd>
  <ul>
    <li>
      <p>
      Use login name instead of user number.
      </p>
    </li>
    <li>
      <p>
      Smoother interface - get rid of the Phoenix home page.
      </p>
    </li>
    <li>
      <p>
      Add Exmachina for tests.
      </p>
    </li>
    <li>
      <p>
      Add commenting.
      </p>
    </li>
  </ul>
  </dd>
</dl>

<hr>

<h2>CS11 Weekly Report 5</h2>
<dl>
  <dt>Tasks Accomplished</dt>
  <dd>
  <ul>
    <li>
      <p>
      Set up models to deal with roles. Add admin role and update tests.
      </p>
    </li>
    <li>
      <p>
      Restrict user creation to admins. Add tests for this functionality.
      </p>
    </li>
    <li>
      <p>
      Allow admins to modify all posts. Add tests for this functionality.
      </p>
    </li>
    <li>
      <p>
      Add role selection to users/new form.
      </p>
    </li>
    <li>
      <p>
      Add new migration to associate posts with users. Seed database with
      "Admin Role" and "User Role." Fix seeds file so that it runs multiple
      times without error.
      </p>
    </li>
    <li>
      <p>
      Prevent running seeds multiple times from duplicating data.
      </p>
    </li>
    <li>
      <p>
      Add ExMachina to create factories for roles, users, and posts
      </p>
    </li>
    <li>
      <p>
      Add comments model. Associate comments with posts. Add routes for
      comments. Add our comments controller and view. Allow users to post
      comments. Display comments after submitting. Add "Approve" and "Delete"
      options for comments for logged in users and don't display comments to
      public until they are approved.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Issues Encountered</dt>
  <dd>
  <ul>
    <li>
      <p>
      Missing User Role.  Creating new user only allows "Admin Role". Fixed by
      updating seeds.exs file to add "User Role".
      </p>
    </li>
    <li>
      <p>
      Running seeds file multiple times duplicates data. Check if role or
      username already creates before adding.
      </p>
    </li>
    <li>
      <p>
      Tests fail because they are trying to create a user that already exists.
      Modify the create_user() method to delete the user if the username
      exists before creating the user.
      </p>
    </li>
    <li>
      <p>
      Internel server error after upgrading release when accessing
      <a href="http://jkleong.com/users">
        http://jkleong.com/users</a>.<br>
      </p>
      <p>
      Related to issue from last week.
      Fixed by including the upgrade.exs file which called "mix ecto.migrate".
      </p>
    </li>
    <li>
      <p>
      Release 0.0.5 didn't work on production. Needed to add earmark to
      "applications" in mix.exs.
      </p>
    </li>
    <li>
      <p>
      NPM error when pushing to production.<br>
      remote: $ npm run deploy (/home/justin/the_juice)<br>
      remote: > @ deploy /home/justin/the_juice<br>
      remote: > brunch build --production<br>
      remote: sh: 1: brunch: not found<br>

      </p>
    </li>
  </ul>
  </dd>

  <dt>Next Week's Tasks</dt>
  <dd>
  <ul>
    <li>
      <p>
      Live comments
      </p>
    </li>
    <li>
      <p>
      Use login name instead of user number.
      </p>
    </li>
    <li>
      <p>
      Smoother interface - get rid of the Phoenix home page.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Meeting Notes</dt>
  <dd>
  <ul>
    <li>
      <p>
      Finish the stuff that wasn't finished last week.
      </p>
    </li>
  </ul>
  </dd>
</dl>

<hr>

<h2>CS11 Weekly Report 6</h2>
<dl>
  <dt>Tasks Accomplished</dt>
  <dd>
  <ul>
    <li>
      <p>
      Got rid of Phoenix logo and links on home page.
      </p>
    </li>
    <li>
      <p>
      Added Omega/Ohm favicon.
      </p>
    </li>
    <li>
      <p>
      Add link to user's posts on front page.
      <a href="https://jkleong.com">
        https://jkleong.com</a>.<br>
      </p>
    </li>
  </ul>
  </dd>

  <dt>Issues Encountered</dt>
  <dd>
  <ul>
    <li>
      <p>
      GET test failed since the content had changed. Tried to change the
      content but the test still failed. A closer inspection revealed that the
      issue was that an apostrophe is represented as "& # 3 9;" with no spaces
      in between the letters in html.
      </p>
    </li>
    <li>
      <p>
      TODO
      </p>
    </li>
  </ul>
  </dd>

  <dt>Next Week's Tasks</dt>
  <dd>
  <ul>
    <li>
      <p>
      Live comments
      </p>
    </li>
    <li>
      <p>
      Use login name instead of user number.
      </p>
    </li>
    <li>
      <p>
      Smoother interface - get rid of the Phoenix home page.
      </p>
    </li>
  </ul>
  </dd>

  <dt>Meeting Notes</dt>
  <dd>
  <ul>
    <li>
      <p>
      TODO
      </p>
    </li>
  </ul>
  </dd>
</dl>

<hr>
<font size="-1">
Last updated April 28, 2017.<br>
</font>




</body></html>
